# vibAnalysis
Tools for performing vibrational analysis on molecular systems.

## About vibAnalysis
**vibAnalysis** is a tool for aiding the interpretation of vibrational spectra
using the Vibrational Mode Decomposition (VMD) paradigm. This is an alternative
approach to the well-established Potential Energy Decomposition (PED) scheme
implemented in software packages such as [VEDA](http://smmg.pl/software/veda). 

Under VMD, the movement associated with a vibrational mode is decomposed into a
set of redundant internal coordinates. For each vibrational mode, the most
prominent internal coordinates describing the atomic motions are listed,
together with their respective weights. In **vibAnalysis**, we implemented three
different "flavours" of VMD, which differ in the way such weights are
determined:
1. Vibrational Mode Projection (VMP)
1. Vibrational Mode Linear Decomposition (VMLD), and
1. Vibrational Mode Automatic Relevance Determination (VMARD)

The latter of which is the default method used by **vibAnalysis**. VMP and VMLD
are simple methods based on vector projection and linear least-squares
regression, respectively. In its turn, VMARD uses the [Automatic Relevance
Determination](http://scikit-learn.org/stable/modules/linear_model.html#automatic-relevance-determination-ard)
(ARD) method, which is a variant of Bayesian Ridge Regression to better estimate
the most prominent internal coordinates. This results on a much clearer picture
of the internal coordinates describing the atomic motions.

Currently, **vibAnalysis** can perform VMP, VMLD, VMARD, as well as animate
vibrational motions and displacements along internal coordinates.

## System Requirements
**vibAnalysis** is written in Python 3, and should work in any modern system. Its
only requirements are:
* [Numpy](http://www.numpy.org/)
* [Scikit-learn](http://scikit-learn.org/stable/) 

**vibAnalysis** has the ability to export the animation of vibrational modes and
displacements along internal coordinates using the xyz format which can be
easily opened using [Molden](http://www.cmbi.ru.nl/molden/).

## How to Use
Assuming you have downloaded the _va.py_, have permissions to execute it, and it
is in your executable PATH. If you run _va.py_ without any argument, it will
print its help on the terminal.

```
Usage: ./va.py [ Commands ] [ Options ] inputFile

Commands:
 --icc        Perform Internal Coordinate Contribution analysis (default).
 --noicc      Don't perform Internal Coordinate Contribution analysis.
 --nmp        Perform Normal Mode Decomposition analysis.
 --nonmp      Don't perform Normal Mode Decomposition (default).
 --ld         Perform Normal Mode Linear Decomposition analysis.
 --nold       Don't perform Normal Mode Linear Decomposition (default).
 --ard        Perform Normal Mode ARD Decomposition analysis (default).
 --noard      Don't perform Normal Mode ARD Decomposition analysis.

Options:
 --linear     System is linear (3N-5 vibrational modes expected).
 --ts         System is a transition state 
              (first vibrational mode will be included as reaction coordinate).
 --mw         Use mass-weighted displacements (default).
 --rawd       Don't use mass-weighted displacements.
 --pure       Purify internal coordinates.
 --autosel    Automatic selection of internal coordinates.  
 --allic      Don't purify internal coordinates (default)
 --cut XX     Set the cutoff for presenting contributions:
              'auto' - Automatic selection (default)
              'all'  - All contributions are listed.
              'd9'   - Always lists the top 90% most important contributions
              'q1'   - Always lists the top 25% most important contributions
              X      - List only contributions above X%
 --delta f.ff Use this value for the discrete computation of S.
 --tol XX     Tolerance (in %) for determination of atomic connectivity.
 --input XX   Input format:
              'hess'   - Orca .hess file (default).
              'g09'    - Gaussian09 output (log) file.
 --vm XX      Animate vibrational mode XX 
 --ic XX      Animate internal coordinate XX 
```

### Basic Usage
**vibAnalysis** can read from either the output of Gaussian09 or from the hess
file generated by Orca (the latter being the default). The defaults are sensible
enough for most uses. Thus, it can be invoked only as:

```
va.py myFreqRun.hess
```

for analysing the hess file from Orca. The results will be punched onto a file
named _myFreqRun_.nma. If you prefer to use Gaussian for your calculations, you
can use

```
va.py --input g09 myFreqRun.log
```

as before, the results will be saved on a file named  _myFreqRun_.nma. 

### Animating Vibrational Modes and Internal Coordinates

You can animate one or more vibrational modes using **vibAnalysis**, just use
the --vm option followed by a list of the modes to animate, for example:

```
./va.py --vm 11 12 acoh-hess.hess
```

will make the VMARD analysis and also punch the animation of vibrational modes
11 and 12 onto files named acoh-hess.v011.xyz and acoh-hess.v012.xyz. The
numbering of the vibrational modes corresponds to those on the nma file, which
may or may not correspond to the ordering read in the files generated by the
Quantum chemistry packages.

In a similar manner, the motion along a single internal coordinate can be
animated using the --ic option, for example:

```
./va.py --ic 11 12 acoh-hess.hess
```

will punch the animation along internal coordinates 11 and 12 onto files
acoh-hess.i011.xyz and acoh-hess.i012.xyz, respectively. These files can be
used to inspect the displacement along each internal coordinate, or can be used
to perform Potential Energy Surface (PES) scans for the parametrisation of
molecular force fields.

## How to Cite
A paper describing the Vibrational Mode Decomposition paradigm and the three
"flavours" available in **vibAnalysis** is currently undergoing the submission
process to a peer-reviewed journal. While this paper is not published, and you
wish to publish your work using **vibAnalysis**, please please put a reference to
this gitHub repository. The following BibTeX entry should provide you with all
the needed information:

```bibtex
@Electronic{TeixeiraVibAnal,
  author    = {Filipe Teixeira},
  title     = {VibAnalysis - Tools for performing vibrational analysis on molecular systems},
  year      = {2017},
  date      = {2017-07-04},
  url       = {https://github.com/teixeirafilipe/vibAnalysis},
  urldate   = {2017-07-04}
}
```

